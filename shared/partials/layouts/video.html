<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Universal Path Resolver - Loads first, cached across pages -->
    <script src="../../../common/core/path-resolver-init.js"></script>

    <!-- Import map for module path aliases -->
    <script type="importmap">
      {
        "imports": {
          "@/": "/common/",
          "#/": "/shared/",
          "$/": "/pages/"
        }
      }
    </script>

<meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Homepage with Video Background - Legacy Concierge</title>
    <link rel="icon" href="../../../favicon.svg" />

    <link rel="stylesheet" href="../../../shared/theme/style.css" />
    <link rel="stylesheet" href="../../../shared/theme/layouts/homepage.css" />

    <style>
      /* Homepage Video Layout Styles */
      .hero-video {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .hero-video video {
        position: absolute;
        top: 50%;
        left: 50%;
        min-width: 100%;
        min-height: 100%;
        width: auto;
        height: auto;
        transform: translate(-50%, -50%);
        z-index: -1;
        object-fit: cover;
      }

      .hero-video::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          135deg,
          rgba(11, 41, 53, 0.7) 0%,
          rgba(11, 41, 53, 0.4) 100%
        );
        z-index: 0;
      }

      .hero-content {
        position: relative;
        z-index: 1;
        text-align: center;
        color: white;
        max-width: 800px;
        padding: 2rem;
      }

      .hero-content h1 {
        font-size: 3.5rem;
        margin-bottom: 1rem;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .hero-content .subtitle {
        font-size: 1.5rem;
        margin-bottom: 2rem;
        opacity: 0.95;
      }

      .hero-actions {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
      }

      .hero-actions .cta-button {
        padding: 1rem 2.5rem;
        font-size: 1.1rem;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .hero-content h1 {
          font-size: 2rem;
        }

        .hero-content .subtitle {
          font-size: 1.1rem;
        }
      }

      /* Reduced motion */
      @media (prefers-reduced-motion: reduce) {
        .hero-video video {
          animation: none;
        }
      }
    </style>

    <script type="module">
      import { initializeComponents } from "@/core/component-loader.js";

      document.addEventListener("DOMContentLoaded", async () => {
        await initializeComponents(["header", "footer"]);

        // Video handling
        const video = document.querySelector(".hero-video video");
        if (video) {
          // Pause video if user prefers reduced motion
          if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
            video.pause();
          }

          // Pause video if not in viewport (performance)
          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  video
                    .play()
                    .catch((e) => console.log("Video autoplay prevented"));
                } else {
                  video.pause();
                }
              });
            },
            { threshold: 0.25 }
          );

          observer.observe(video);
        }
      });
    </script>

    <script src="../../../common/services/theme.js"></script>
    <script src="../../../common/services/i18n.js"></script>
    <script type="module">
      import { loadTemplates } from "@/core/component-loader.js";
      loadTemplates(["header", "footer"], true);
    </script>
  </head>

  <body itemscope itemtype="http://schema.org/WebPage">
    <a href="#main" class="skip-link" data-i18n="accessibility.skipToMain"></a>

    <!-- Header (transparent over video) -->
    <lc-header transparent></lc-header>

    <!-- Hero Section with Background Video -->
    <section class="hero-video">
      <video autoplay muted loop playsinline preload="auto">
        <source
          src="../../../shared/assets/media/videos/hero-nursing-care.mp4"
          type="video/mp4"
        />
        <source
          src="../../../shared/assets/media/videos/hero-nursing-care.webm"
          type="video/webm"
        />
        <!-- Fallback image -->
        <img
          src="../../../shared/assets/media/hero-fallback.jpg"
          alt="Compassionate nursing care"
        />
      </video>

      <div class="hero-content">
        <h1 data-i18n="title">Premier In-Home Nursing Care</h1>
        <p class="subtitle" data-i18n="subtitle">
          Compassionate, expert nursing in the comfort of your home
        </p>
        <div class="hero-actions">
          <a
            href="../../../pages/contact"
            class="cta-button"
            data-i18n="ctaButton.getStarted"
          >
            Get Started
          </a>
          <a href="../../../pages/about" class="cta-button cta-button-secondary">
            Learn More
          </a>
        </div>
      </div>
    </section>

    <main role="main" id="main">
      <!-- Rest of homepage content -->
      <section class="container">
        <h2>Why Choose Legacy Concierge?</h2>

        <lc-card-grid columns="4" gap="2rem">
          <lc-card variant="info" animated>
            <h4 slot="title" data-i18n="infoCards[0].title"></h4>
            <p data-i18n="infoCards[0].text"></p>
          </lc-card>

          <lc-card variant="info" animated>
            <h4 slot="title" data-i18n="infoCards[1].title"></h4>
            <p data-i18n="infoCards[1].text"></p>
          </lc-card>

          <lc-card variant="info" animated>
            <h4 slot="title" data-i18n="infoCards[2].title"></h4>
            <p data-i18n="infoCards[2].text"></p>
          </lc-card>

          <lc-card variant="info" animated>
            <h4 slot="title" data-i18n="infoCards[3].title"></h4>
            <p data-i18n="infoCards[3].text"></p>
          </lc-card>
        </lc-card-grid>
      </section>

      <!-- Additional sections as needed -->
    </main>

    <lc-footer></lc-footer>

    <lc-google-tag disabled></lc-google-tag>

    <!-- Component System -->
    <script type="module">
      import { loadTemplates } from "@/core/component-loader.js";

      // Load templates and initialize components
      (async () => {
        try {
          // Load all required templates first
          const templateResults = await loadTemplates(
            ["header", "footer", "cards"],
            true
          );
          const allLoaded = templateResults.every((result) => result === true);

          if (!allLoaded) {
            console.error("✗ Some templates failed to load:", templateResults);
            console.error("  Check the console for fetch errors above");
            return;
          }

          console.log("✓ All component templates loaded successfully");

          // Import component scripts
          await Promise.all([
            import("@/components/lc-header.js"),
            import("@/components/lc-footer.js"),
            import("@/components/lc-card.js"),
          ]);
          console.log("✓ Component scripts loaded successfully");

          // Wait a tick for components to render
          await new Promise((resolve) => setTimeout(resolve, 100));

          // Re-apply i18n translations to components
          if (window.applyTranslations) {
            await window.applyTranslations();
            console.log("✓ i18n translations applied to components");
          }

          // Setup theme toggle (now that component has rendered)
          if (window.setupThemeToggle) {
            window.setupThemeToggle();
          }

          // Setup language toggle (now that component has rendered)
          const languageToggle = document.querySelector(".language-toggle");
          if (languageToggle && window.switchLanguage) {
            languageToggle.addEventListener("click", () => {
              const currentLang = document.documentElement.lang;
              const newLang = currentLang === "en" ? "es" : "en";
              window.switchLanguage(newLang);
            });
            console.log("✓ Language toggle initialized");
          }
        } catch (error) {
          console.error("Failed to initialize components:", error);
        }
      })();
    </script>
  </body>
</html>
